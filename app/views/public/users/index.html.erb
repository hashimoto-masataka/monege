<div class ="container-fluid">
  <div class="row">
    <div class ="col-7 offset-1">
      <h2 class= "headline mt-5">参考にしたユーザ一覧</h2>
        <% if @users.exists? %>
          <%= render 'public/users/index',users: @users %>
        <% else %>
          <p>ユーザーはいません</p>
        <% end %>
    </div>
  </div>
</div>


<script>

const category_data = {
  labels: [
    <% @users.each do |user| %>
     <% user.categories.each do | category| %>
      '<%= category.category_name %>',
    <% end %>
    <% end %>
    ],
  datasets: [
    {
      label: 'カテゴリー表',
      data: [
        <% @users.each do |user| %>
           <% user.categories.each do | category| %>
            '<%= category.target_price %>',
           <% end %>
        <% end %>
      ],
    }
  ]
};

const elements = document.getElementsByClassName('pie');
for(let i = 0; i < elements.length; i++) {
  new Chart(elements[i], {
      type: 'pie',
      data: category_data,
      options: {
    /*    scales: {
          y: {
            beginAtZero: true
          }
        }
        */
      }
    });
}

</script>